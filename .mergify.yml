# Mergify Configuration
# Documentation: https://docs.mergify.com/

pull_request_rules:
  # ü§ñ Auto-merge for Dependabot PRs
  - name: Auto-merge Dependabot PRs when CI passes
    conditions:
      - author=dependabot[bot]
      - check-success=TypeScript Check
      - check-success=Lint Code
      - check-success=Check Formatting
      - check-success=Tests & Coverage
      - check-success=Build Application
      - '#approved-reviews-by>=0'
    actions:
      merge:
        method: squash
      delete_head_branch: {}
      comment:
        message: |
          ‚úÖ Auto-merged by Mergify
          All checks passed, Dependabot PR has been automatically merged.

  # üè∑Ô∏è Auto-merge for PRs with 'automerge' label
  - name: Auto-merge PRs with automerge label
    conditions:
      - label=automerge
      - check-success=TypeScript Check
      - check-success=Lint Code
      - check-success=Check Formatting
      - check-success=Tests & Coverage
      - check-success=Build Application
      - '#approved-reviews-by>=0'
      - -draft
    actions:
      merge:
        method: squash
      delete_head_branch: {}
      comment:
        message: |
          ‚úÖ Auto-merged by Mergify
          All checks passed. Auto-merging with automerge label.

  # üè∑Ô∏è Auto-label Dependabot PRs
  - name: Label Dependabot PRs
    conditions:
      - author=dependabot[bot]
    actions:
      label:
        add:
          - dependencies
          - automated

  # üêõ Auto-label by PR title prefix
  - name: Label bug fixes
    conditions:
      - 'title~=^fix'
    actions:
      label:
        add:
          - bug

  - name: Label features
    conditions:
      - 'title~=^feat'
    actions:
      label:
        add:
          - enhancement

  - name: Label documentation
    conditions:
      - 'title~=^docs'
    actions:
      label:
        add:
          - documentation

  - name: Label refactoring
    conditions:
      - 'title~=^refactor'
    actions:
      label:
        add:
          - refactoring

  - name: Label tests
    conditions:
      - 'title~=^test'
    actions:
      label:
        add:
          - tests
